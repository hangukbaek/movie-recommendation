<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì˜¤ëŠ˜ì˜ ì˜í™” ì¶”ì²œ</title>
  <link rel="stylesheet" href="style.css" />
  <!-- main.js: ì¥ë¥´ ê´€ë ¨ ì½”ë“œë§Œ ìœ ì§€, ì½œë°±í˜• êµ¬ê¸€ ë¡œê·¸ì¸ì€ JS í•„ìš” ìµœì†Œí™” -->
  <script src="main.js" defer></script>
</head>
<body>
  <header>
    <h1>ğŸ¬ ì˜¤ëŠ˜ì˜ ì˜í™” ì¶”ì²œ</h1>
    <!-- 'ë¡œê·¸ì¸' ë²„íŠ¼ í´ë¦­ ì‹œ /auth/google ë¡œ ì´ë™ â†’ êµ¬ê¸€ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰íŠ¸ -->
    <button class="btn-login" id="googleLoginBtn">ë¡œê·¸ì¸</button>
  </header>

  <div class="genre-buttons">
    <button class="active">ì•¡ì…˜</button>
    <button>ì½”ë¯¸ë””</button>
    <button>SF</button>
    <button>ê³µí¬</button>
    <button>ìŠ¤ë¦´ëŸ¬</button>
    <button>ë¡œë§¨ìŠ¤</button>
    <button>ìŠ¤í¬ì¸ </button>
  </div>

  <!-- ì¥ë¥´ì— ë”°ë¼ ì˜í™”ê°€ ë°”ë€ŒëŠ” ì˜ì—­ -->
  <div class="container" id="genre-movie-container" style="margin-top: 20px;">
    <!-- ì—¬ê¸°ì— API ì‘ë‹µìœ¼ë¡œ ì˜í™” ì¹´ë“œë“¤ì´ ì£¼ì…ë¨ -->
  </div>

  <div class="container">
    <div class="list-box">
      <div class="section-title">(ì£¼ê°„) ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ìˆœìœ„</div>
      <ol id="boxoffice-list">
        <!-- APIë¡œ ì±„ì›Œì§ˆ ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ë¦¬ìŠ¤íŠ¸ -->
      </ol>
    </div>

    <div>
      <div class="card">
        <div class="section-title">ì´ì£¼ì˜ Hot ë­í‚¹ (ì˜í™”)</div>
        <!-- ë°°ìš° ì •ë³´ (ì´ë¯¸ì§€ + ì´ë¦„ ë“±) ì—¬ê¸°ì— ë™ì  ì£¼ì… -->
      </div>

      <div class="card" style="margin-top: 20px;">
        <div class="section-title">ì´ì£¼ì˜ Hot ë­í‚¹ (ë°°ìš°)</div>
        <div id="hot-actor">
          <!-- ë°°ìš° ì •ë³´ (ì´ë¯¸ì§€ + ì´ë¦„ ë“±) ì—¬ê¸°ì— ë™ì  ì£¼ì… -->
        </div>
      </div>
    </div>
  </div>

  <div class="container" style="margin-top: 20px;">
    <div class="card">
      <div class="section-title">í™ê¸¸ë™ë‹˜ì„ ìœ„í•œ ì¶”ì²œ ì˜í™”</div>
      <div id="user-recommendation">
        <!-- ì¶”ì²œ ì˜í™” ì •ë³´ ì—¬ê¸°ì— ë™ì  ì£¼ì… -->
      </div>
    </div>
  </div>

  <script>
    // ì½œë°± ë°©ì‹: ë‹¨ìˆœíˆ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ /auth/googleë¡œ ì´ë™
    document.addEventListener("DOMContentLoaded", () => {
      const loginBtn = document.getElementById("googleLoginBtn");
      if (loginBtn) {
        loginBtn.addEventListener("click", () => {
          // ì„œë²„ ë¼ìš°íŠ¸ /auth/google ë¡œ ì´ë™
          window.location.href = "/auth/google";
        });
      }
    });
    document.addEventListener("DOMContentLoaded", () => {
    const loginBtn = document.getElementById("googleLoginBtn");
    if (loginBtn) {
      loginBtn.addEventListener("click", () => {
        const currentPath = window.location.pathname + window.location.search;
        window.location.href = `/auth/google?redirect=${encodeURIComponent(currentPath)}`;
      });
    }

    // âœ… ë¡œê·¸ì¸ ì™„ë£Œ í›„ í† í°ì´ ì¿¼ë¦¬ì— í¬í•¨ë˜ì–´ ìˆë‹¤ë©´ ì €ì¥ + ë¡œê·¸ ì¶œë ¥
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get("token");

    if (token) {
      localStorage.setItem("token", token);
      console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ: JWTê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");

      // ì£¼ì†Œì°½ì—ì„œ token ì œê±° (URL ê¹”ë”í•˜ê²Œ ìœ ì§€)
      urlParams.delete("token");
      const newUrl =
        window.location.pathname +
        (urlParams.toString() ? "?" + urlParams.toString() : "");
      history.replaceState({}, "", newUrl);
    }
  });
  </script>
  
</body>
</html>
