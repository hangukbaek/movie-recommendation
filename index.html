<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì˜¤ëŠ˜ì˜ ì˜í™” ì¶”ì²œ</title>

  <!-- í°íŠ¸ + ìŠ¤íƒ€ì¼ -->
  <link href="https://fonts.googleapis.com/css2?family=Cafe24+Ssurround&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <script src="main.js" defer></script>
  <script src="server.js" defer></script>
</head>
<body>
  <header>
    <div class="header-left">
      <h1>ğŸ¬ ì˜¤ëŠ˜ì˜ ì˜í™” ì¶”ì²œ</h1>
    </div>
  
    <div class="header-center">
      <div class="search-bar">
        <input type="text" id="search-input" placeholder="ì˜í™” ì œëª©ì„ ê²€ìƒ‰í•˜ì„¸ìš”" />
        <button id="search-button">ğŸ”</button>
        <div id="search-history" class="search-history" style="display: none;"></div>
      </div>
    </div>
  
    <div class="header-right">
      <span id="login-status" style="color: white; margin-right: 10px;"></span>
      <button class="btn-login" id="googleLoginBtn">ë¡œê·¸ì¸</button>
      <button class="btn-logout" id="logoutBtn" style="display:none;">ë¡œê·¸ì•„ì›ƒ</button>
      <button class="btn-mypage" id="myPageBtn" style="display:none;">ë§ˆì´í˜ì´ì§€</button>
      <button onclick="toggleTheme()" class="theme-toggle-btn">ğŸŒ“ í…Œë§ˆ ì „í™˜</button>
    </div>
  </header>
  
  <!-- ì¥ë¥´ ë²„íŠ¼ í™•ì¥ -->
  <div class="genre-buttons">
    <button class="active">ì•¡ì…˜</button>
    <button>ì½”ë¯¸ë””</button>
    <button>SF</button>
    <button>ê³µí¬</button>
    <button>ìŠ¤ë¦´ëŸ¬</button>
    <button>ë¡œë§¨ìŠ¤</button>
    <button>ìŠ¤í¬ì¸ </button>
    <button>ì• ë‹ˆë©”ì´ì…˜</button>
    <button>ë‹¤íë©˜í„°ë¦¬</button>
    <button>íŒíƒ€ì§€</button>
  </div>

  <!-- ì¥ë¥´ë³„ ì˜í™” ì¹´ë“œ -->
  <div class="container" id="genre-movie-container" style="margin-top: 20px;">
    <!-- ì¥ë¥´ ì„ íƒ ê²°ê³¼ ì¹´ë“œ ì£¼ì… ì˜ˆì • -->
  </div>

  <!-- ë©”ì¸ ì½˜í…ì¸  -->
  <div class="container">
    <div>
      <!-- ë°•ìŠ¤ì˜¤í”¼ìŠ¤ -->
      <div class="list-box">
        <div class="section-title">(ì£¼ê°„) ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ìˆœìœ„</div>
        <ol id="boxoffice-list"></ol>
      </div>

      <!-- ì‚¬ìš©ì ë§ì¶¤ ì¶”ì²œ -->
      <div class="card recommendation" style="margin-top: 20px;">
        <div class="section-title"><span id="user-name">í™ê¸¸ë™</span>ë‹˜ì„ ìœ„í•œ ì¶”ì²œ ì˜í™”</div>
        <div id="user-recommendation"></div>
      </div>
    </div>

    <div>
      <!-- Hot ë­í‚¹ (ì˜í™”) -->
      <div class="card hot-movie">
        <div class="section-title">ì´ì£¼ì˜ Hot ë­í‚¹ (ì˜í™”)</div>
        <div class="slider-wrapper">
          <button class="slide-button left" onclick="slideHotMovie(-1)">&#10094;</button>
          <div class="slider-content" id="hot-movie-slider">
            <div class="slider-item"><img src="í¬ìŠ¤í„°1.jpg" /></div>
            <div class="slider-item"><img src="í¬ìŠ¤í„°2.jpg" /></div>
            <div class="slider-item"><img src="í¬ìŠ¤í„°3.jpg" /></div>
            <div class="slider-item"><img src="í¬ìŠ¤í„°4.jpg" /></div>
            <div class="slider-item"><img src="í¬ìŠ¤í„°5.jpg" /></div>
          </div>
          <button class="slide-button right" onclick="slideHotMovie(1)">&#10095;</button>
        </div>
      </div>

      <!-- Hot ë­í‚¹ (ë°°ìš°) -->
      <div class="card hot-actor" style="margin-top: 20px;">
        <div class="section-title">ì´ì£¼ì˜ Hot ë­í‚¹ (ë°°ìš°)</div>
        <div class="slider-wrapper">
          <button class="slide-button left" onclick="slideHotActor(-1)">&#10094;</button>
          <div class="slider-content" id="hot-actor-slider">
            <div class="slider-item"><img src="actor1.jpg" /></div>
            <div class="slider-item"><img src="actor2.jpg" /></div>
            <div class="slider-item"><img src="actor3.jpg" /></div>
            <div class="slider-item"><img src="actor4.jpg" /></div>
            <div class="slider-item"><img src="actor5.jpg" /></div>
            <div class="slider-item"><img src="actor6.jpg" /></div>
          </div>
          <button class="slide-button right" onclick="slideHotActor(1)">&#10095;</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Google ë¡œê·¸ì¸ ì½œë°± ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const loginBtn = document.getElementById("googleLoginBtn");
      if (loginBtn) {
        loginBtn.addEventListener("click", () => {
          const currentPath = window.location.pathname + window.location.search;
          window.location.href = `/auth/google?redirect=${encodeURIComponent(currentPath)}`;
        });
      }

      // JWT ì €ì¥ ì²˜ë¦¬
      const urlParams = new URLSearchParams(window.location.search);
      const token = urlParams.get("token");

      if (token) {
        localStorage.setItem("token", token);
        console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ: JWTê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");

        // token ì œê±°í•œ URLë¡œ ìƒˆë¡œê³ ì¹¨ ì—†ì´ ì£¼ì†Œì°½ ì •ë¦¬
        urlParams.delete("token");
        const newUrl =
          window.location.pathname +
          (urlParams.toString() ? "?" + urlParams.toString() : "");
        history.replaceState({}, "", newUrl);
      }
    });
  </script>

</body>
</html>
